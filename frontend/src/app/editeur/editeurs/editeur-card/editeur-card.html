<article class="editeur-card">
  <div class="editeur-content" tabindex="0" [routerLink]="['/editeurs', editeur().id]">
    <header>
      <div class="editeur-top">
        <h3>{{ editeur().name }}</h3>
      </div>
      <div class="editeur-meta">
        @if (editeur().type_reservant) {
          <span class="badge">{{ editeur().type_reservant }}</span>
        }
        @if (editeur().est_reservant === false) {
          <span class="badge outline">Non réservant</span>
        }
      </div>
      <p class="editeur-description">{{ editeur().description }}</p>
    </header>
  </div>

  <div class="card-actions">
    @if (authService.canManageFestivals()) {
    <button type="button" class="btn-action" (click)="onCreateContact($event)">
      {{ showForm() ? 'Fermer' : 'Ajouter un contact' }}
    </button>


    <button type="button" class="btn-action" (click)="onShowContact($event)">
      {{ showContacts() ? 'Cacher' : 'Voir les contacts' }}
    </button>
    }
  </div>

  @if (showForm()) {
  <div class="form-container" (click)="$event.stopPropagation()">
    <app-contact-form (add)="handleContactAdd($event)" />
  </div>
  }

  @if (showContacts()) {
  <div class="contacts-list" (click)="$event.stopPropagation()">
    @for (c of associatedContacts(); track c.id) {
    <app-contact [contact]="c" (remove)="handleDeleteContact($event)" />
    } @empty {
    <p class="empty-msg">Aucun contact trouvé pour cet éditeur.</p>
    }
  </div>
  }
</article>
