<article class="festival-card" [routerLink]="['/festivals', festival.id]" style="cursor: pointer;">
  <header>
    <h3 class="festival-name">{{ festival.name }}</h3>
    <p class="festival-location"><strong>Lieu :</strong> {{ festival.location }}</p>

    <div class="festival-dates">
      <p><strong>Début :</strong> {{ festival.displayDateDebut }}</p>
      <p><strong>Fin :</strong> {{ festival.displayDateFin }}</p>
    </div>
  </header>

  @if (isCurrent()) {
  <span class="current-pill">Festival courant</span>
  }

  <div class="festival-body">


    @if (festival.description && festival.description.length > 0) {
    <p class="festival-description">
      {{ festival.description }}
    </p>
    }
  </div>

  <div class="festival-stats">
    <p><strong>Total tables :</strong> {{ totalTables() }}</p>
    <p><strong>Disponibles :</strong> {{ totalAvailable() }}</p>
  </div>

  <div class="current-actions" (click)="$event.stopPropagation()">
    <button type="button" class="secondary-button" (click)="setCurrent($event)" [disabled]="isCurrent()">
      Définir comme courant
    </button>
  </div>

  @if (festival.tariffZones?.length) {
  <ul class="tariff-zones">
    @for (zone of festival.tariffZones; track zone.id ?? zone.name) {
    <li class="tariff-zone">
      <span class="zone-name">{{ zone.name }}</span>
      <span class="zone-details">
        {{ zoneAvailable(zone) }} dispo / {{ zone.totalTables }} tables
      </span>
    </li>
    }
  </ul>
  } @else {
  <p class="empty">Aucune zone tarifaire.</p>
  }

  @if (auth.isAdmin()) {
  <footer class="actions" (click)="$event.stopPropagation()">
    <a class="primary-button" [routerLink]="['/reservations']" [queryParams]="{ festivalId: festival.id }">
      Gérer les réservations
    </a>

    <a class="secondary-button" [routerLink]="['/festivals', festival.id, 'edit']">
      Modifier
    </a>
  </footer>
  }
</article>
